# Storage: EBS, EFS

## EBS (Elastic Block Store)

- 네트워크 기반 블록 스토리지 서비스
- EC2 인스턴스용 영구 블록 스토리지 볼륨

## 특징

- AZ에 고정
  - 동일 AZ의 EC2만 연결 가능
- 네트워크를 통해 인스턴스에 연결
  - 약간의 지연 존재
  - 인스턴스 독립적(영구 스토리지)
- 기본적으로 하나의 EBS는 하나의 EC2에만 연결
  - 하나의 EC2는 기본적으로 여러 EBS에 연결 가능
- 크기(GiB), IOPS(초당 읽기/쓰기 요청 수), 처리량ㄴ을 프로비저닝해야 함

### EBS 볼륨 유형

- 범용 SSD(gp3, gp2)
- 프로비저닝된 IOPS SSD(io2, io1)
  - Multi-Attach 지원
- 처리량 최적화 HDD(st1)
- Cold HDD(sc1)
  - 최저 비용, 자주 액세스 안함
  - 아카이브 용도
  - 부팅 볼륨으로 사용 불가

### EBS 스냅샷

- EBS 볼륨의 특정 시점 백업
- 증분식 백업: 첫 스냅샷 이후 변경된 블록만 저장
- 다른 AZ 또는 리전으로 복사 가능
- 스냅샷을 기반으로 새 EBS 볼륨 생성 가능

### 추가 기능

- 암호화 가능
- EBS 최적화 인스턴스 설정 가능

#### EBS 스냅샷 특수 기능

- EBS 스냅샷 아카이브
  - 스냅샷을 아카이브 계층으로 이동하여 비용 75% 절감
  - 아카이브 복원 시간 존재(24~72시간)
- EBS 스냅샷 휴지통
  - 삭제된 스냅샷을 1일~1년 동안 보존
  - 실수로 삭제된 스냅샷 복구 가능
  - 보존 규칙 설정 가능
- 빠른 스냅샷 복원 (Fast Snapshot Restore, FSR)
  - 스냅샷에서 볼륨 생성 시 전체 초기화 강제 수행
  - 첫 액세스 시 지연 시간 제거
  - 비용이 많이 들지만 즉각적인 성능 필요 시 유용
  - AZ당 활성화 필요

#### EBS 다중 연결 기능 (Multi-Attach)

- 기본적으로 하나의 EBS는 하나의 EC2에만 연결
  - Multi-Attach를 사용하는 경우 하나의 EBS가 여러 EC2에 연결 가능
- 제한 사항
  - 프로비저닝된 IOPS SSD (io1, io2)만 Multi-Attach 기능 지원  
  - 한 볼륨은 최대 16개의 인스턴스에 동시 연결 가능
  - 클러스터 인식 파일 시스템 사용 필수 (XFS, EXT4 등 일반 파일 시스템 사용 불가능)

---

## 인스턴스 스토어 (Instance Store)

- EC2 인스턴스에 물리적으로 연결된 로컬 블록 스토리지
- 특정 인스턴스 타입에서만 제공
  - 인스턴스 유형 중 d가 붙은 인스턴스만 지원
  - m5.large(미지원), m5d.large(지원)
  - 해당 유형의 인스턴스는 무조건 인스턴스 스토어 포함, 루트 EBS 볼륨도 무조건 포함

### 특징

- 고성능 I/O
  - 물리적으로 연결되어 있기 때문에 인스턴스 스토어가 EBS보다 성능 우수
  - 매우 높은 IOPS, 낮은 지연 시간
- 인스턴스에 종속적
  - 임시 스토리지로 분류
  - 인스턴스 중지 또는 종료 시 데이터 손실
- 크기 변경 불가능
- 백업은 사용자 책임
  - EBS와 달리 자동 백업, 스냅샷 없음
  - 중요한 데이터는 인스턴스 스토어에 저장하지 말 것
